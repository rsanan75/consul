<h2><%= t("admin.users.index.title") %></h2>
<div class="small-12 medium-6">
  <%= form_tag admin_users_path, method: :get, remote: true  do %>
    <div class="input-group">
      <%= text_field_tag :search, "", placeholder: t("admin.users.search.placeholder") %>
      <div class="input-group-button">
        <%= submit_tag t("admin.users.search.search"), class: "button" %>
      </div>
    </div>
  <% end %>
</div>
  
<% if @users.any? %>
<h3 class="inline-block"><%= @users.count %> items</h3>
<%= link_to "Download Users", url_for(params.permit(:page).merge(:format => "csv")), class: "small float-right clear" %>
<%= javascript_include_tag 'https://cdn.datatables.net/v/dt/dt-1.10.22/datatables.min.js' %>
<%= stylesheet_link_tag 'https://cdn.datatables.net/v/dt/dt-1.10.22/datatables.min.css' %>
<%= javascript_include_tag 'https://cdn.datatables.net/v/dt/dt-1.10.22/datatables.min.js' %>
<%= stylesheet_link_tag 'https://cdn.datatables.net/v/dt/dt-1.10.22/datatables.min.css' %>

<style>
    table.dataTable thead .sorting {
        background-image: none;
    }
    table.dataTable thead .sorting_asc {
        background-image: none;
    }
    table.dataTable thead .sorting_desc {
        background-image: none;
    }
    table.dataTable thead .sorting_asc_disabled {
        background-image: none;
    }
    table.dataTable thead .sorting_desc_disabled {
        background-image: none;
    }
</style>
  <table id="users_list">
    <thead>
      <tr>
        <th><%= t("customtext.registration_page.label_name") %></th>
        <th><%= t("admin.users.columns.name") %></th>
        <th><%= t("admin.users.columns.email") %></th>
        <th><%= t("customtext.registration_page.label_created") %></th>
        <th><%= t("customtext.admin.download_users.verified_status") %></th> 
      </tr>
    </thead>

    <tbody>
      <% @users.each do |user| %>
      <% if user.confirmed_at.nil? %>
            <% verified_status = user.confirmation_token %>
        <% else %>
            <% verified_status = 'verified' %>
        <% end %>
        <tr id="<%= dom_id(user) %>" class="user">
          <td><%= user.read_attribute_before_type_cast("name") %>, <%= user.surname %></td>
          <td><%= user.username %></td>
          <td><%= user.email %></td>
          <td><%= user.created_at.strftime("%m-%d-%Y") %></td>
          <td><%= verified_status %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

 <script>
    

  // Setup - add a text input to each footer cell
    $('#user_list thead tr').clone(true).appendTo( '#user_list thead' );
    $('#user_list thead tr:eq(1) th').each( function (i) {
        var title = $(this).text();
        $(this).html( '<input type="text" placeholder="Search '+title+'" />' );
 
        $( 'input', this ).on( 'keyup change', function () {
            if ( table.column(i).search() !== this.value ) {
                table
                    .column(i)
                    .search( this.value )
                    .draw();
            }
        } );
    } );
 
    var table = $('#user_list').DataTable( {
        "order": [ [ 1, "asc" ] ],
        "columnDefs": [ { "targets": 3, "orderable": false } ],
        orderCellsTop: true,
        fixedHeader: true
    } );

</script>

<% else %>
  <div class="callout primary">
    There are no Users.
  </div>
<% end %>